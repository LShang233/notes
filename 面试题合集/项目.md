# 滴滴H5

**滴滴企业版H5端**

**「描述」**滴滴企业版是为企业提供出行服务及出行管理的应用，包含APP、小程序、以及H5端。企业开通账号，员工即可使用企业版叫车，由企业账户直接支付。包含加班、差旅、接送机等场景，简化报销流程。

**「背景」**冒泡页6.0以及首页3.0版本更新

**「方案」**1、组件重构，使用FC与hook代替CC

2、

**「技术」**React，hook

## 介绍

滴滴企业版是B端的一个产品，主要是为企业提供出行服务以及出行管理的一个平台，他包含了小程序、APP、以及H5端。企业给员工配置制度，也就是使用场景，当员工符合该场景时，费用直接由企业支付，也就省去了这部分报销的流程。

现在主要的模块是出行，以及差旅；出行就是日常的加班周末用车，差旅是出差或旅游的酒店出行费用。

我跟我的导师主要是负责H5用车，以及首页部分（就是下面四个导航栏直达的页面，包括登录，设置等）



那么最近这个项目有一个大的改动，就是冒泡页6.0以及首页3.0，因为这是一个大的版本更新，所以主要是在一些功能、逻辑以及展示上有一个大的改变，后台的接口也进行了大改，因为我实习的比较晚，所以只参与了这里面收尾的一些工作



改动包括，之前版本用户体验上的改动：添加回到当前位置的按钮，右上角首页，根据上一个订单的车型默认选择等等

以及逻辑展示：配置支付渠道、等待答应（200+熔断，排队优化）



我们是一个五六年前的老项目，借此大改的机会，我们也将一些老的组件进行了整合以及重构，将class component转为了function component







**数据层面，纯函数，业务封装方式，公司框架源码，这些都可以写**



6.0体验优化：终点锁定城市、自定义勾选车型、配置支付渠道、修改气泡样式、等待答应（200+熔断，排队优化）



redux转hooks



# 出租车

## 介绍项目

当前我国出租车行业发展呈下降趋势，但是出租车作为当今重要的出行工具，这个行业的发展会直接影响城市道路还有居民的生活质量等方面，所以从中挖掘出有效信息是很重要的意义的

所以我们设计了一套系统，后台根据广州市两个月的出租车出行数据进行分析后，使用网页端、移动端进行展示，而我负责了网页端的构建

我主要负责需求情况的数据，包括车辆的主要流向图和详细区域，以及出租车利用率和收入的数据图表



## 困难，怎么解决

主要还是**数据量大**的问题

一开始测试的时候，只是简单的申请数据并渲染，但是速度特别慢，页面至少要等待几十秒

所以我们进行了多方面的处理

1. 增加了点击动画和loading，但这并不能改变根本的问题
2. 因为主要是地图模块一些密度大的数据导致的卡顿，比如说点云图，所以减少了返回到前端的数据量，考虑到页面也不可能展示过多的数据
3. 将数据文件进行了压缩，减少了不必要的精度
4. 将一些固定的数据上传到oss上
5. 后面还换了一个更好一点的服务器，处理一些必须实时返回的数据
6. **ajax数据预获取**



 



## 1、对请求进行统一处理，开发者只需关注请求成功拿到数据时的业务处理

其实就是对所有api进行统一的处理

封装一个方法，对所有的数据进行预处理，比如说post方法自动转json格式，formDate方法自动在添加header，如果发生错误，统一跳转到写好的错误页面

其实其他项目也有使用这个，处理方式也大同小异，就是多了一个自动添加token的功能，如果没有token就跳转到未登录页面



## 2、对数据进行预获取，提高响应速度

因为数据量大，如果等用户选择后再进行下载会很慢

因为一个日期会显示多种图表。所以我们选择初次渲染，渲染一个数据量比较小的这种图表，

然后像是点云图、热力图这些需要大量数据量的，我们会在选取日期之后，进行异步获取。

这样当用户选择看这些数据量大图表的时候，就会比较快的渲染出来。



## 节流

主要是对用户的请求进行了优化，防止用户多次请求，当用户申请数据的时候，加上一道锁，在返回数据并渲染完成后再进行解锁。

因为按钮基本上都是下拉框的形式，所以不会像输入框和按钮那样频繁，所以没有选择防抖。





# QG 工作室招新系统 

「描述」面对全校新生的招新系统，分为小程序端和管理端。小程序端面向用户和管理员，用于面试的全部流 程，包括报名，通知，签到排队以及打分评价等功能。管理端为 web 页面，包括数据分析，面试结 果，编辑面试信息等管理功能。 

「成就」访问量 900+，投入简历 200+，面试排队功能投入使用 

「职责」小程序端团队介绍、排队签到；管理端负责人，页面框架搭建，数据统计、考试结果等模块开发 

「亮点」1、小程序性能优化 2、使用 webSocket 和心跳机制实现实时排队人数 

「技术」微信小程序，webSocket，Vue，Echarts

## 介绍

面对全校新生的招新系统，分为小程序端和管理端。小程序端面向用户和管理员，用于面试的全部流 程，包括报名，通知，签到排队以及打分评价等功能。管理端为 web 页面，包括数据分析，面试结 果，编辑面试信息等管理功能

## 困难，怎么解决

因为是第一次使用小程序，所以在实际开发上会有很多细节上的问题

比如说同样的方式但是小程序会页面卡顿，以及一些小程序自带的接口更新

前者会根据具体情况进行优化

后者基本上找博客看文档就能解决，印象中比较深刻的一个问题是用户登录的模块，旧接口在十几天前不支持了（而且她在开发者根据和真机调试的效果还不一样），因为比较新，网上也找不到博客，最后是通过博客指引到文档

## 使用节流对小程序动画性能优化 

宣传页面有使用微信的卡片组件，但是当用户频繁滑动的时候，会无限的添加事件，也就导致了只有当页面停止滚动的时候才能后续的操作

所以我对滑动事件进行了节流，每三秒才能滑动一次

## 使用懒加载处理图片，减少请求



## 使用 webSocket 和心跳机制实现实时排队人数

使用websocket接收服务器推送

为了保证是否能接受这个服务器的推送，我们使用了心跳机制，也就是隔一段时间发送一一段数据给后台，判断这个链接是否还继续连着。如果我不行的话，那么就重新连接这个链接。



## 小程序性能优化

「[启动性能](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips/start)」和「[运行时性能](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips)」

- 设计：简约
- 图片压缩并上传oss
- 下拉框卡片：
  - 直接用小程序的默认样式
  - 改变屏幕大小，修改层叠关系和相对布局
  - 问题：当用户频繁多次的下滑的时候，动画会一直循环，无法暂停，同时部分元素会移位
  - 锁定了下拉操作，直到动画结束才能进行下一次操作
- setDate使用少

- [合理使用 setData](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips/runtime_setData.html)
- [渲染性能优化](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips/runtime_render.html)
- [页面切换优化](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips/runtime_nav.html)
- [资源加载优化](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips/runtime_resource.html)
- [内存优化](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips/runtime_memory.html)



# **在线开放课程：程序设计基础**

**「描述」**面对学习C语言程序设计基础的系统，包括课程信息、视频学习、资源下载、课后小测和课堂讨论等     功能。搭配做题系统Anywork，分为教师端和学生端，含考试、做题、错题收藏、错误分析等功能。

**「职责」**课程资源，关于我们，错题收藏

**「亮点」**1、使用 rem 实现页面自适应

​      		  2、使用图片懒加载减少请求

**「技术」**react，react-router，redux

## 使用 rem 实现页面自适应，利用媒体查询实现响应式布局 

修改根节点的文字大小，里面的文字都通过rem设置

有一些卡片的效果，也是用媒体查询实现的，主要是设置一排放几张卡这样

因为项目开始的时候又让设计师尽量复用

## 使用虚拟滚动加载讨论模块，实现按需渲染



里面有一些活动剪影、课程评价等模块，都是一些图片资源，使用懒加载

因为不一定会用到，而且少量下载时也不慢

然后对于课程的相关信息课件，使用的是预加载的方式，习题课件等信息会常用到

