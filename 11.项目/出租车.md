# 出租车

## 介绍项目

当前我国出租车行业发展呈下降趋势，但是出租车作为当今重要的出行工具，这个行业的发展会直接影响城市道路还有居民的生活质量等方面，所以从中挖掘出有效信息是很重要的意义的

所以我们设计了一套系统，后台根据广州市两个月的出租车出行数据进行分析后，使用网页端、移动端进行展示，而我负责了网页端的构建

我主要负责需求情况的数据，包括车辆的主要流向图和详细区域，以及出租车利用率和收入的数据图表



## 困难，怎么解决

主要还是**数据量大**的问题

一开始测试的时候，只是简单的申请数据并渲染，但是速度特别慢，页面至少要等待几十秒

所以我们进行了多方面的处理

1. 增加了点击动画和loading，但这并不能改变根本的问题
2. 因为主要是地图模块一些密度大的数据导致的卡顿，比如说点云图，所以减少了返回到前端的数据量，考虑到页面也不可能展示过多的数据
3. 将数据文件进行了压缩，减少了不必要的精度
4. 将一些固定的数据上传到oss上
5. 后面还换了一个更好一点的服务器，处理一些必须实时返回的数据
6. **ajax数据预获取**



 



## 1、对请求进行统一处理，开发者只需关注请求成功拿到数据时的业务处理

其实就是对所有api进行统一的处理

封装一个方法，对所有的数据进行预处理，比如说post方法自动转json格式，formDate方法自动在添加header，如果发生错误，统一跳转到写好的错误页面

其实其他项目也有使用这个，处理方式也大同小异，就是多了一个自动添加token的功能，如果没有token就跳转到未登录页面



## 2、对数据进行预获取，提高响应速度

因为数据量大，如果等用户选择后再进行下载会很慢

因为一个日期会显示多种图表。所以我们选择初次渲染，渲染一个数据量比较小的这种图表，

然后像是点云图、热力图这些需要大量数据量的，我们会在选取日期之后，进行异步获取。

这样当用户选择看这些数据量大图表的时候，就会比较快的渲染出来。



## 节流

主要是对用户的请求进行了优化，防止用户多次请求，当用户申请数据的时候，加上一道锁，在返回数据并渲染完成后再进行解锁。

因为按钮基本上都是下拉框的形式，所以不会像输入框和按钮那样频繁，所以没有选择防抖。



